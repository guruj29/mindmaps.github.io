<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Linear Algebra Mind Map â€” Safe Mode</title>
  <style>
    :root {
      --bg: #0b1020; --ink: #e8ecff; --muted: #9fb0ff;
    }
    html, body { height: 100%; margin: 0; background: var(--bg); color: var(--ink);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial; }
    .app { display: grid; grid-template-rows: 56px 1fr; height: 100vh; }
    header { display: flex; align-items: center; gap: 10px; padding: 10px 14px;
      border-bottom: 1px solid rgba(255,255,255,0.08); }
    header h1 { margin: 0; font-size: 16px; }
    header .sub { font-size: 12px; color: var(--muted); }
    /* ðŸ‘‡ This guarantees the drawing area has height in every browser */
    #wrap { width: 100%; height: calc(100vh - 56px); position: relative; overflow: hidden; }
    svg { width: 100%; height: 100%; display: block; cursor: grab; }
    .node circle { fill: #1a2246; stroke: #6285ff; stroke-width: 1.2px; }
    .node text { fill: var(--ink); font-size: 12px; }
    .link { fill: none; stroke: rgba(255,255,255,0.25); stroke-width: 1.2px; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Linear Algebra Mind Map</h1>
      <span class="sub">safe mode â€” should always render nodes & links</span>
    </header>
    <div id="wrap"><svg id="svg"></svg></div>
  </div>

  <script>
  // Minimal data
  const data = {
    name: "Linear Algebra",
    children: [
      { name: "Prerequisites", children: [
        { name: "Algebra" }, { name: "Equations" }, { name: "Functions" }, { name: "Geometry (basics)" }
      ]},
      { name: "Core Concepts", children: [
        { name: "Vectors" }, { name: "Matrices" }, { name: "Linear Transformations" }, { name: "Systems of Linear Equations" }, { name: "Geometry in R^n" }
      ]},
      { name: "Matrix Computations", children: [
        { name: "Matrix Operations", children: [
          { name: "Addition & Scalar mult." }, { name: "Matrix Multiplication" }, { name: "Transpose" }, { name: "Inverse / Determinant" }
        ]},
        { name: "Special Matrices", children: [
          { name: "Diagonal / Triangular" }, { name: "Symmetric / Skew-symmetric" }, { name: "Orthogonal / Unitary" }, { name: "Hermitian / PSD" }, { name: "Sparse / Structured" }
        ]}
      ]},
      { name: "Theory", children: [
        { name: "Vector Spaces", children: [
          { name: "Subspaces" }, { name: "Linear Independence" }, { name: "Basis & Dimension" }, { name: "Rankâ€“Nullity" }
        ]},
        { name: "Eigenstuff", children: [
          { name: "Eigenvalues" }, { name: "Eigenvectors" }, { name: "Diagonalization" }, { name: "SVD" }
        ]}
      ]},
      { name: "Applications", children: [
        { name: "Physics" }, { name: "Chemistry" }, { name: "Biology" }, { name: "Economics" }, { name: "Business" },
        { name: "Computing" }, { name: "Signal Processing" }, { name: "Probability" }, { name: "Quantum" }
      ]}
    ]
  };

  // Tiny helper: tree structure
  function H(obj, depth=0, parent=null){
    const n={data:obj, depth, parent, children:null, _children:null};
    if (obj.children?.length) n.children = obj.children.map(c=>H(c, depth+1, n));
    return n;
  }
  const root = H(data);

  // Lay out nodes in a radial pattern based on the SVG size
  function layout(size){
    const [W,H] = size;
    const cx = W/2, cy = H/2;
    let leaves = [], maxDepth = 0;
    (function collect(n){
      maxDepth = Math.max(maxDepth, n.depth);
      const kids = n.children || [];
      if (!kids.length) leaves.push(n);
      kids.forEach(collect);
    })(root);

    const R = Math.min(W, H)/2 - 40;
    const step = (2*Math.PI) / Math.max(1, leaves.length);
    let i = 0;
    (function place(n){
      const kids = n.children || [];
      if (!kids.length){
        const a = i * step - Math.PI/2;
        const r = (n.depth/(maxDepth||1)) * R;
        n.x = cx + r*Math.cos(a);
        n.y = cy + r*Math.sin(a);
        i++;
      }
      kids.forEach(place);
    })(root);

    const levels = [];
    (function gather(n){ (levels[n.depth] ||= []).push(n); (n.children||[]).forEach(gather); })(root);
    for (let d=maxDepth-1; d>=0; d--){
      for (const n of (levels[d]||[])){
        const kids = n.children || [];
        if (kids.length){
          n.x = kids.reduce((s,c)=>s+c.x,0)/kids.length;
          n.y = kids.reduce((s,c)=>s+c.y,0)/kids.length;
        } else if (n.depth === 0) { n.x = cx; n.y = cy; }
      }
    }
  }

  // Render
  const svg = document.getElementById('svg');
  const g = document.createElementNS('http://www.w3.org/2000/svg','g');
  svg.appendChild(g);

  function links(n){
    const out = [];
    (function walk(x){
      const kids = x.children || [];
      kids.forEach(c => { out.push({s:x,t:c}); walk(c); });
    })(n);
    return out;
  }

  function render(){
    const r = svg.getBoundingClientRect();
    layout([r.width, r.height]);

    g.innerHTML = ""; // simple redraw

    // edges
    for (const L of links(root)){
      const p = document.createElementNS('http://www.w3.org/2000/svg','path');
      const d = `M ${L.s.x},${L.s.y} C ${(L.s.x*2+L.t.x)/3},${(L.s.y*2+L.t.y)/3} ${(L.s.x+L.t.x*2)/3},${(L.s.y+L.t.y*2)/3} ${L.t.x},${L.t.y}`;
      p.setAttribute('class','link'); p.setAttribute('d', d);
      g.appendChild(p);
    }

    // nodes
    (function draw(n){
      const gn = document.createElementNS('http://www.w3.org/2000/svg','g');
      gn.setAttribute('class','node');
      gn.setAttribute('transform', `translate(${n.x},${n.y})`);

      const c = document.createElementNS('http://www.w3.org/2000/svg','circle');
      c.setAttribute('r', 10); gn.appendChild(c);

      const t = document.createElementNS('http://www.w3.org/2000/svg','text');
      t.setAttribute('x', 14); t.setAttribute('y', 4);
      t.textContent = n.data.name; gn.appendChild(t);

      g.appendChild(gn);
      (n.children||[]).forEach(draw);
    })(root);
  }

  addEventListener('resize', render);
  render();
  </script>
</body>
</html>
